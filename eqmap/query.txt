    SELECT X.*   FROM (
SELECT DISTINCT LOCN_TTNAME ,LOCN_X,LOCN_Y,nvl(SUM(FAULTS_REPORTED),0) 
AS FAULTS_REPORTED,nvl(SUM(FAULTS_REPORTED_WITHOUT_REPEAT),0) AS FAULTS_REPORTED_WITHOUT_REPEAT, nvl(SUM(MSAN_PORT_ISSUES),0)
AS MSAN_PORT_ISSUES,nvl(SUM(CPE_ISSUES),0) AS CPE_ISSUES, nvl(SUM(UG_FAULTS),0) AS  UG_FAULTS,
".$countstring."  TOTAL_FAULT_COUNT 
FROM FRAME_UNITS FU, FRAME_CONTAINERS FC , FRAME_APPEARANCES fa ,RTSU_DP nc , LOCATIONS l
WHERE FU.FRAU_FRAC_ID = FC.FRAC_ID
and fu.FRAU_ID = fa.FRAA_FRAU_ID
AND fc.FRAC_FRAN_NAME IN ( 'DP','FDP')
AND fa.FRAA_SIDE = 'REAR'
AND FC.FRAC_LOCN_TTNAME = L.LOCN_TTNAME
AND FU.FRAU_NAME = DP
AND MOPMC = '".$opmc."'
AND SERVICE_TYPE IN (".$ser.")
    AND LOCN_X IS NOT NULL
GROUP BY LOCN_TTNAME,LOCN_X,LOCN_Y)X
    ORDER BY TOTAL_FAULT_COUNT
